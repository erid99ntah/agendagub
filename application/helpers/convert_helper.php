<?php  if (!defined('BASEPATH')) exit('No direct script access allowed');
/**
 *
 * @author Yogi Kaputra
 *
 */

/**
 * Fungsi untuk memberikan huruhayf besar pada awal judul
 * @param string $array
 * @return string
 */
if (!function_exists('ucwords_title')) {
  function ucwords_title($str) {
    $arr = array();
    $conc = explode(' ', 'dan pada di atau yang dari tetapi padahal sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambilatau tetapi sesudah jika agar supaya dengan bahwa karena ketika maka sedangkan hingga meski lalu sambil serta apabila lagi pula andaikata sebab sebelum selama sehingga seandainya sekiranya melainkan semenjak andaikan bagaikan asalkan jangankan walaupun meskipun kendatipun lagi hanya sekalipun sungguhpun melainkan sampai-sampai tatkala kecuali seraya sambil');
    $caps = explode(' ', 'TIK IT');
    $str_array = explode(' ', $str);
    foreach ($str_array as $text) {
      if (!preg_match("/^\(/", $text)) {
        if(!in_array($text, $caps)) {
          $text = strtolower($text);
        }
      }
      if (!in_array($text, $conc)) {
        $str = ($text == 'e-government') ? 'e-Government' : ucwords($text);
      } else {
        $str = $text;
      }
      $arr[] = $str;
    }
    return implode(' ', $arr);
  }
}

if (!function_exists('jabatan_title')) {
  function jabatan_title($str) {
    $arr = array();
    $conc = explode(' ', 'sekretaris kepala daerah dinas badan biro');
    //$str = strtolower($str);
    $str_array = explode(' ', $str);
    foreach ($str_array as $text) {
      if (!preg_match("/^\(/", $text)) {
        $text = strtolower($text);
      }
      if (in_array($text, $conc)) {
        $str = strtoupper($text);
      } else {
        $str = strtoupper($text);
      }
      $arr[] = $str;
    }
    return implode(' ', $arr);
  }
}

if (!function_exists('space')) {
  function space($str) {
    if (empty($str)) {
      return;
    }
    return str_replace('-', ' ', $str);
  }
}

if (!function_exists('no_space')) {
  function no_space($str) {
    if (empty($str)) {
      return;
    }
    return str_replace(' ', '', $str);
  }
}

if (!function_exists('upper')) {
  function upper($str) {
    return strtoupper(strtolower($str));
  }
}

if (!function_exists('capital_each_word')) {
  function capital_each_word($str) {
    $asal = array('DI', 'DAN');
    $jadi = array('di', 'dan');
    if (in_array($asal, $jadi))
      return ucwords(strtolower($str));
  }
}

if (!function_exists('separator_to_list')) {
  function separator_to_list($str) {
    $arr = explode('|', $str);
    $li = '<ul>';
    foreach ($arr as $value) {
      $li.='<li>' . $value . '</li>';
    }
    $li.='</ul>';
    return $li;
  }
}

if (!function_exists('escape')) {
  function escape($str) {
    $CI = & get_instance();
    return $CI->db->escape_str($str);
  }
}

if (!function_exists('kosongkan')) {
  function kosongkan($jml) {
    return ($jml == 0) ? '' : $jml;
  }
}

if (!function_exists('format_ribuan')) {
  function format_ribuan($jml) {
    if ($jml == 0) {
      return $jml;
    }
    return number_format($jml, 0, ',', '.');
  }
}

if (!function_exists('nb2gol')) {
  function nb2gol($number) {
    $number = abs($number);
    if (intval($number) == 0) {
      return;
    }
    $arr = array(
      1 => 'I',
      2 => 'II',
      3 => 'III',
      4 => 'IV',
    );
    return @$arr[$number];
  }
}

if (!function_exists('tambah_nol')) {
  function tambah_nol($number, $total) {
    $jumlah_nol = strlen($number);
    $angka_nol  = $total - $jumlah_nol;
    $nol = "";
    for($i=1;$i<=$angka_nol;$i++) {
      $nol .= '0';
    }
    return $nol.$number;
  }
}

/**
 * Fungsi convert matauang rupiah
 */
if (!function_exists('convert_rupiah')) {
  function convert_rupiah($nominal) {
    $hasil = "Rp. " .number_format($nominal , 0 , "" , '.') . ",-";
    return $hasil;
  }
}

/**
 * Fungsi convert matauang rupiah
 */
if (!function_exists('nominal_rupiah')) {
  function nominal_rupiah($nominal) {
    $hasil = "Rp   ".number_format($nominal , 0 , "" , ',');
    return $hasil;
  }
}

if (!function_exists('datereplace')) {
  function datereplace($date) {
    $date = str_replace('-', '', $date);
    return $date;
  }
}

if (!function_exists('datesubstr')) {
  function datesubstr($date) {
    $y = substr($date,0,4);
    $m = substr($date,4,2);
    $d = substr($date,6,2);
    return $y."-".$m."-".$d;
  }
}

/**
 * Fungsi get provinsi
 */
if (!function_exists('currentIdUser')) {
  function currentIdUser($username) {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('username', $username);
    $ci->db->where('id_status', 1);
    $ci->db->where('blokir', 0);
    $row = $ci->db->get('xi_sa_users')->row_array();
    $id_users = !empty($row) ? $row['id_users'] : '';
    return $id_users;
  }
}

/**
 * Fungsi get study
 */
if (!function_exists('pendidikan')) {
  function pendidikan($id) {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('id', $id);
    $row = $ci->db->get('ref_pendidikan')->row_array();
    $study = !empty($row) ? $row['study'] : '';
    return $study;
  }
}

/**
 * Fungsi get rs rujukan
 */
if (!function_exists('rujukan')) {
  function rujukan($id, $type='SHORT') {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('id_rs', $id);
    $row = $ci->db->get('ms_rs_rujukan')->row_array();
    $nm_rs = !empty($row) ? (($type == 'FULL') ? $row['fullname'] : $row['shortname'])  : '';
    return $nm_rs;
  }
}

/**
 * Fungsi get hospital
 */
if (!function_exists('hospital')) {
  function hospital($id, $flag=0) {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('id_rs', $id);
    $row = $ci->db->get('ms_rs_rujukan')->row_array();
    $nm_rs = !empty($row) ? (($flag == 1) ? $row['fullname'].' ['.$row['kode_fasyankes'].']' : $row['fullname'])  : '';
    return $nm_rs;
  }
}

/**
 * Fungsi get provinsi
 */
if (!function_exists('provinsi')) {
  function provinsi($id) {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('id', $id);
    $row = $ci->db->get('wa_province')->row_array();
    $nm_prov = !empty($row) ? $row['name'] : '';
    return $nm_prov;
  }
}

/**
 * Fungsi get regency
 */
if (!function_exists('regency')) {
  function regency($id) {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('id', $id);
    $row = $ci->db->get('wa_regency')->row_array();
    $nm_daerah = !empty($row) ? (($row['status'] == 1) ? "KAB ".$row['name'] : $row['name']) : '';
    return $nm_daerah;
  }
}

/**
 * Fungsi get district
 */
if (!function_exists('district')) {
  function district($id) {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('id', $id);
    $row = $ci->db->get('wa_district')->row_array();
    $nm_district = !empty($row) ? $row['name'] : '';
    return $nm_district;
  }
}

/**
 * Fungsi get district
 */
if (!function_exists('village')) {
  function village($id) {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->where('id', $id);
    $row = $ci->db->get('wa_village')->row_array();
    $nm_village = !empty($row) ? $row['name'] : '';
    return $nm_village;
  }
}

if (!function_exists('tgl_dinas')) {
  function tgl_dinas($tgl_pergi, $tgl_kembali) {
    if($tgl_pergi != '0000-00-00' AND $tgl_kembali != '0000-00-00') {
      if(date('m', strtotime($tgl_pergi)) == date('m', strtotime($tgl_kembali))) {
        if(date('d', strtotime($tgl_pergi)) == date('d', strtotime($tgl_kembali)))
          $tgl_dinas = tgl_indo($tgl_pergi);
        else
          $tgl_dinas = date('d', strtotime($tgl_pergi)).' - '.tgl_indo($tgl_kembali);
      } else
        $tgl_dinas = tgl_indo($tgl_pergi).' s/d '.tgl_indo($tgl_kembali);
    } else if($tgl_pergi != '0000-00-00' AND $tgl_kembali == '0000-00-00') {
        $tgl_dinas = tgl_indo($tgl_pergi);
    } else {
      $tgl_dinas = '-';
    }
    return $tgl_dinas;
  }
}

if (!function_exists('waktu_input')) {
  function waktu_input() {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->select('waktu_input');
    $row = $ci->db->get('ref_setting')->row_array();
    $time = date('H:i:s', strtotime($row['waktu_input']));
    return $time;
  }
}

if (!function_exists('waktu_publish')) {
  function waktu_publish() {
    $ci =& get_instance();
    $ci->load->database();
    $ci->db->select('waktu_publish');
    $row = $ci->db->get('ref_setting')->row_array();
    $time = date('H:i:s', strtotime($row['waktu_publish']));
    return $time;
  }
}

if (!function_exists('terbilang')) {
  function terbilang($angka) {
    $angka = (float)$angka;
    $bilangan = array('','Satu','Dua','Tiga','Empat','Lima','Enam','Tujuh','Delapan','Sembilan','Sepuluh','Sebelas');

    if ($angka < 12) {
        return $bilangan[$angka];
    } else if ($angka < 20) {
        return $bilangan[$angka - 10] . ' Belas';
    } else if ($angka < 100) {
        $hasil_bagi = (int)($angka / 10);
        $hasil_mod = $angka % 10;
        return trim(sprintf('%s Puluh %s', $bilangan[$hasil_bagi], $bilangan[$hasil_mod]));
    } else if ($angka < 200) {
        return sprintf('Seratus %s', terbilang($angka - 100));
    } else if ($angka < 1000) {
        $hasil_bagi = (int)($angka / 100);
        $hasil_mod = $angka % 100;
        return trim(sprintf('%s Ratus %s', $bilangan[$hasil_bagi], terbilang($hasil_mod)));
    } else if ($angka < 2000) {
        return trim(sprintf('Seribu %s', terbilang($angka - 1000)));
    } else if ($angka < 1000000) {
        $hasil_bagi = (int)($angka / 1000);
        $hasil_mod = $angka % 1000;
        return sprintf('%s Ribu %s', terbilang($hasil_bagi), terbilang($hasil_mod));
    } else if ($angka < 1000000000) {
        $hasil_bagi = (int)($angka / 1000000);
        $hasil_mod = $angka % 1000000;
        return trim(sprintf('%s Juta %s', terbilang($hasil_bagi), terbilang($hasil_mod)));
    } else if ($angka < 1000000000000) {
        $hasil_bagi = (int)($angka / 1000000000);
        $hasil_mod = fmod($angka, 1000000000);
        return trim(sprintf('%s Milyar %s', terbilang($hasil_bagi), terbilang($hasil_mod)));
    } else if ($angka < 1000000000000000) {
        $hasil_bagi = $angka / 1000000000000;
        $hasil_mod = fmod($angka, 1000000000000);
        return trim(sprintf('%s Triliun %s', terbilang($hasil_bagi), terbilang($hasil_mod)));
    } else {
        return 'Data Salah';
    }
  }
}

if (!function_exists('cutText')) {
  function cutText($text, $length, $mode = 2) {
    if(strlen($text) > $length) {
      if ($mode != 1) {
  		  $char = $text{$length - 1};
    		switch($mode) {
    			case 2:
    				while($char != ' ') {
    					$char = $text{--$length};
    				}
    			case 3:
    				while($char != ' ') {
    					$char = $text{++$length};
    				}
    		}
  	  }
      $string = substr($text, 0, $length);
    } else
      $string = $text;

	  return $string;
  }
}

if (!function_exists('array_group_by')) {
	/**
	 * Groups an array by a given key.
	 *
	 * Groups an array into arrays by a given key, or set of keys, shared between all array members.
	 *
	 * Based on {@author Jake Zatecky}'s {@link https://github.com/jakezatecky/array_group_by array_group_by()} function.
	 * This variant allows $key to be closures.
	 *
	 * @param array $array   The array to have grouping performed on.
	 * @param mixed $key,... The key to group or split by. Can be a _string_,
	 *                       an _integer_, a _float_, or a _callable_.
	 *
	 *                       If the key is a callback, it must return
	 *                       a valid key from the array.
	 *
	 *                       If the key is _NULL_, the iterated element is skipped.
	 *
	 *                       ```
	 *                       string|int callback ( mixed $item )
	 *                       ```
	 *
	 * @return array|null Returns a multidimensional array or `null` if `$key` is invalid.
	 */
	function array_group_by(array $array, $key)
	{
		if (!is_string($key) && !is_int($key) && !is_float($key) && !is_callable($key) ) {
			trigger_error('array_group_by(): The key should be a string, an integer, or a callback', E_USER_ERROR);
			return null;
		}
		$func = (!is_string($key) && is_callable($key) ? $key : null);
		$_key = $key;
		// Load the new array, splitting by the target key
		$grouped = [];
		foreach ($array as $value) {
			$key = null;
			if (is_callable($func)) {
				$key = call_user_func($func, $value);
			} elseif (is_object($value) && isset($value->{$_key})) {
				$key = $value->{$_key};
			} elseif (isset($value[$_key])) {
				$key = $value[$_key];
			}
			if ($key === null) {
				continue;
			}
			$grouped[$key][] = $value;
		}
		// Recursively build a nested grouping if more parameters are supplied
		// Each grouped array value is grouped according to the next sequential key
		if (func_num_args() > 2) {
			$args = func_get_args();
			foreach ($grouped as $key => $value) {
				$params = array_merge([ $value ], array_slice($args, 2, func_num_args()));
				$grouped[$key] = call_user_func_array('array_group_by', $params);
			}
		}
		return $grouped;
	}

  function setWarna($val){   
    if ($val!='') {
      if ($val==1)
      $bg ="bgcolor='#16a085';";
      else
      $bg ="";
    }
    else{
      $bg='';
    }
    return $bg;
  }

  if (!function_exists('convert_level_akses')) {
    function convert_level_akses($id) {
      $ci =& get_instance();
      $ci->load->database();
      $ci->db->where('id_level_akses', $id);
      $row = $ci->db->get('xi_sa_level_akses')->row_array();
      $level = $row['level_akses'];
      return $level;
    }
  }

  if (!function_exists('convert_jabatan')) {
    function convert_jabatan($id) {
      $ci =& get_instance();
      $ci->load->database();
      $ci->db->where('id_jabatan', $id);
      $row = $ci->db->get('xi_sa_jabatan')->row_array();
      $jab = $row['nm_jabatan'];
      return $jab;
    }
  }
}

/* End of file string_helper.php */
/* Location: ./application/helpers/string_helper.php */
